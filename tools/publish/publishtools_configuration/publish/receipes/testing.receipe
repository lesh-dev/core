#!/bin/bash
# Generated from template on Tue Oct  9 22:33:23 MSK 2012
# Please don't forget to commit all changes to repo

components=" preprod_copy"
branch=master
target=/srv/www/clones/testing
sympolicy=none

# This will be executed while publishing component begin
function hook_begin
{
    rm -rf $target
    echo -en  # Add something useful is you want
}

# This will be executed while publishing component preprod_copy
function hook_preprod_copy
{
    echo -en  # Add something useful is you want
}

# This will be executed while publishing component end
function hook_commit
{
    cd $target
    if [ $(pwd) != $target ]; then
        echo " *** ERROR *** Can't create save state"
    else
        git add -A
        git commit -am "save state"
    fi
}

function hook_reset
{
    cd $target
    if [ $(pwd) != $target ]; then
        echo " *** ERROR *** Can't create save state"
    else
        git reset --hard
        git clean -f
        chown -R www-data:www-data .
    fi
}

function hook_end
{
    cd $target
    if [ $(pwd) != $target ]; then
        echo " *** ERROR *** Can't create save state"
    else
        git init
        hook_commit
    fi
    echo -en  # Add something useful is you want
    apachectl -k graceful
}
